<html>

<head>
<meta http-equiv="Content-Language" content="zh-tw">
<meta name="GENERATOR" content="Microsoft FrontPage 4.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<meta http-equiv="Content-Type" content="text/html; charset=shift_jis">
<title>Servlet Call</title>
</head>

<body>

<div align="center">
  <center>
  <table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="600" id="AutoNumber1" height="15">
    <tr>
      <td width="100%" height="15">

<p style="margin-top: 0; margin-bottom: 0" align="center">
<a href="index.html">
<img border="0" src="images/jlogo.GIF" width="345" height="60"></a></p>

<table width=600 border=0 cellpadding=0 cellspacing=0 style="border-collapse: collapse" bordercolor="#111111">
<tr>
<td width=200 align=left valign=top>
<p style="margin-top: 0; margin-bottom: 0">
<a href="ch11_05_05.html">
<img border="0" src="images/jlogo_previous.gif" width="70" height="18"></a></td>
<td width=205 align=center valign=top>
<p style="margin-top: 0; margin-bottom: 0"><b>
<font size="2"><a href="ch11.html" style="text-decoration: none">
<font color="#000000">Chapter 11</font></a></font></b><p style="margin-top: 0; margin-bottom: 0"><b><font size="2">
<a href="ch11.html" style="text-decoration: none"><font color="#000000">Event</font></a></font></b></TD> 
<td width=195 align=right valign=top> 
<p style="margin-top: 0; margin-bottom: 0"> 
<a href="ch11_05_07.html"> 
<img border="0" src="images/jlogo_next.gif" width="70" height="18"></a></td> 
</tr> 
</table> 
 
<hr align=left color="#000000"> 
<p style="margin-top: 1; margin-bottom: 1">　</p>
<p style="margin-top: 1; margin-bottom: 1"><b><font size="4">
<a name="top"></a>
Servlet Call</font></b></p>      
<p style="margin-top: 1; margin-bottom: 1">　</p> 
<p style="margin-top: 2; margin-bottom: 2"><font size="2"><a href="#param">&#12450;&#12454;&#12488;&#12503;&#12483;&#12488;&#12497;&#12521;&#12513;&#12540;&#12479;&#12540;     
(output parameters)</a></font></p>     
<p style="margin-top: 2; margin-bottom: 2"><font size="2"><a href="#callservlet">Servlet　&#12467;&#12540;&#12523; (call Servlet)</a></font></p>    
<p style="margin-top: 2; margin-bottom: 2"><font size="2"><a href="#returndata">&#12522;&#12479;&#12540;&#12531;&#12487;&#12540;&#12479;     
(return data)</a></font></p>     
<p style="margin-top: 2; margin-bottom: 2"><font size="2"><a href="#servletprop">Servlet      
Call &#12503;&#12525;&#12497;&#12486;&#12451; (Servlet Call properties)</a></font></p>     
<p style="margin-top: 2; margin-bottom: 2"><font size="2"><a href="#servletsample">Servlet    
&#12469;&#12531;&#12503;&#12523; (Servlet sample)</a></font></p>     
<p style="margin-top: 1; margin-bottom: 1">　</p>
<p style="margin-top: 1; margin-bottom: 1; text-indent:20" align="justify"><font size="2">デザインナーは</font><font size="2">      
Servlet Call でパラメーター (parameters) をカスタマイズ (customer) 
の Java&trade;      
Servlet　に伝達することができます。 Servlet は更に複雑な(advanced) 
プロセスをし，或いは EJB (Enterprise Java Bean)をコールできます，その結果をクライアントに返送します。<br>    
Servlet      
Call は拡張できるインタフェース (computing interface) 
を提供する以外，各アプリ間のデータコミニケーション(data exchange and      
communicate)にも使用できます 。</font></p>
<p style="margin-top: 1; margin-bottom: 1; text-indent:20">　</p> 
<p style="margin-top: 1; margin-bottom: 1; text-indent:20">　</p> 
<p style="margin-top: 1; margin-bottom: 1">　</p> 
<p style="margin-top: 1; margin-bottom: 1"><font size="2"><b><a name="param"></a>&#12450;&#12454;&#12488;&#12503;&#12483;&#12488;&#12497;&#12521;&#12513;&#12540;&#12479;&#12540;    
(output parameters)</b></font></p>     
<p style="text-indent: 20; margin-top: 1; margin-bottom: 1">　</p>
<p style="text-indent: 20; margin-top: 1; margin-bottom: 1"><font size="2">&#12487;&#12470;&#12452;&#12531;&#12490;&#12540;&#12399;設定&#12497;&#12521;&#12513;&#12540;&#12479;&#12540;名&#12392;&#12501;&#12457;&#12540;&#12511;&#12517;&#12521;(formula)方式&#12391;&#12497;&#12521;&#12513;&#12540;&#12479;&#12540;&#12434; Servlet&#12395;送&#12426;&#36796;&#12415;&#12414;&#12377;。jLIVE Builder&trade;    
&#12398; Content-Type &#12364; <font face="Courier New"> &quot;application/x-www-form-urlencoded&quot;</font>      
 &#12398;形&#12391;&#12497;&#12521;&#12513;&#12540;&#12479;&#12540;&#12434;伝達&#12391;&#12365;&#12414;&#12377;，&#12487;&#12470;&#12452;&#12531;&#12490;&#12540;&#12399;必&#12378;正確&#12395;&#12497;&#12521;&#12513;&#12540;&#12479;&#12540;&#12398;&#12456;&#12531;&#12467;&#12540;&#12487;&#12451;&#12531;&#12464;(encoding)&#12434;設定&#12375;&#12394;&#12369;&#12428;&#12400;，Servlet    
&#12399;正確&#12394;情報&#12364;得&#12425;&#12428;&#12414;&#12379;&#12435;。</font></p> 
<p style="margin-top: 1; margin-bottom: 1">　</p> 
<p style="margin-top: 1; margin-bottom: 1"><a href="#top"><font color="#003366" size="2">▲Top</font></a></p> 
<p style="margin-top: 1; margin-bottom: 1">　</p>
<p style="margin-top: 1; margin-bottom: 1">　</p>
<p style="margin-top: 1; margin-bottom: 1">　</p>
<p style="margin-top: 1; margin-bottom: 1"><font size="2"><b><a name="callservlet"></a> 
Servlet&#12467;&#12540;&#12523; (call Servlet)</b></font></p>    
<p style="margin-top: 1; margin-bottom: 1">　</p>
<p style="text-indent: 20; margin-top: 1; margin-bottom: 1"><font size="2">&#12459;&#12473;&#12479;&#12510;&#12452;&#12474;(customer)&#12398;Java Servlet    
&#12399; HttpServlet &#12463;&#12521;&#12473; (class)    
&#12363;&#12425;&#32153;承&#12391;&#12365;<font color="#000000">，各種&#12398;&#12450;&#12503;&#12522;&#12469;&#12540;&#12496;&#12540;</font><font color="#000000"> 
</font>(application server) <font color="#000000">&#12395;配置&#12373;&#12428;&#12427;&#12371;&#12392;&#12364;可能</font>&#12391;&#12377;<font color="#000000">。</font>Tomcat&#12398;場合，classes    
或&#12356;&#12399;lib &#12501;&#12457;&#12523;&#12480;&#12540;&#12398;下&#12395;配置&#12375;，Tomcat    
&#12434;&#12522;&#12473;&#12479;&#12540;&#12488;&#12377;&#12428;&#12400;，&#12469;&#12540;&#12499;&#12473;&#12364;立&#12385;上&#12364;&#12426;&#12414;&#12377;。URL&#12391;Servlet&#12434;&#12467;&#12540;&#12523;&#12377;&#12427;時&#12395;，jLIVE Builder&trade;    
&#12399;&#12501;&#12457;&#12540;&#12511;&#12517;&#12521;&#12391; URL　&#12434;組&#12415;立&#12390;&#12414;&#12377;&#12398;&#12391;， Servlet    
&#12507;&#12473;&#12488;名&#12392;IP 換&#12360;&#12427;時&#12418;，正確&#12395;&#12467;&#12540;&#12523;(call)&#12364;&#12391;&#12365;&#12414;&#12377;。例&#12360;&#12400;：&#12469;&#12531;&#12503;&#12523;&#12398;      
Servlet &#12399; <font face="Courier New">&quot;Http://&quot;$ApServerName()$&quot;:8080/servlet/ServletCallTest&quot;</font>      
 &#12398;&#12501;&#12457;&#12540;&#12511;&#12517;&#12521;&#12391;組&#12414;&#12428;&#12383; URL　&#12391;&#12377;。Servlet　&#12467;&#12540;&#12523;&#12364;成功&#12391;&#12365;&#12383;&#12363;&#12393;&#12358;&#12363;，&#12467;&#12493;&#12463;&#12471;&#12519;&#12531; (connection)&#12456;&#12521;&#12540;&#12398;時&#12395;，&#12456;&#12521;&#12540;&#12513;&#12483;&#12475;&#12540;&#12472;&#12364;表示&#12373;&#12428;&#12414;&#12377;<font color="#000000">。</font>&#12487;&#12470;&#12452;&#12531;&#12490;&#12540;&#12399;&#12501;&#12457;&#12540;&#12511;&#12517;&#12521; <font face="Courier New" color="#666699">GetServletResp(&quot;</font><font color="#666699">&#12452;&#12505;&#12531;&#12488;名</font><font face="Courier New" color="#666699">&quot;)</font><font color="#000000">&#12391;返送&#12373;&#12428;&#12383;&#20516;      
( 1 -- 成功，0 --失敗)&#12434;確認&#12375;</font>，Servlet&nbsp;後&#12398;&#12503;&#12525;&#12464;&#12521;&#12511;&#12531;&#12464;&#12434;&#23455;行&#12375;&#12414;&#12377;<font color="#000000">。</font></font></p> 
<p style="margin-top: 1; margin-bottom: 1">　</p> 
<p style="margin-top: 1; margin-bottom: 1"><a href="#top"><font color="#003366" size="2">▲Top</font></a></p> 
<p style="margin-top: 1; margin-bottom: 1">　</p>
<p style="margin-top: 1; margin-bottom: 1">　</p>
<p style="margin-top: 1; margin-bottom: 1">　</p>
<p style="margin-top: 1; margin-bottom: 1"><font size="2"><b><a name="returndata"></a>&#12522;&#12479;&#12540;&#12531;&#12487;&#12540;&#12479;      
(Return data)</b></font></p>     
<p style="text-indent: 20; margin-top: 1; margin-bottom: 1">　</p>
<p style="text-indent: 20; margin-top: 1; margin-bottom: 1"><font size="2">Servlet&#12467;&#12540;&#12523;&#12364;成功&#12395;&#12391;&#12365;&#12383;後&#12395;，&#12487;&#12470;&#12452;&#12531;&#12490;&#12540;&#12399;&#12501;&#12457;&#12540;&#12511;&#12517;&#12521; <font color="#666699" size="2" face="Courier New">GetServletResp(&quot;</font><font color="#666699" size="2">&#12452;&#12505;&#12531;&#12488;名</font><font color="#666699" size="2" face="Courier New">.</font><font color="#666699" size="2">&#12497;&#12521;&#12513;&#12540;&#12479;&#12540;名</font><font color="#666699" size="2" face="Courier New">&quot;)</font><font color="#000000">&#12434;利用&#12375;&#12390;&#12522;&#12479;&#12540;&#12531;&#12487;&#12540;&#12479;&#12434;&#35501;&#12415;&#36796;&#12415;&#12414;&#12377;。jLIVE      
Builder&trade; &#12399;</font><font color="#666699" face="Courier New">&quot;application/x-www-form-urlencoded&quot;</font>  
 &#12398;形&#12391; Servlet&#12395;伝達&#12375;&#12414;&#12377;，&#12522;&#12479;&#12540;&#12531;&#12487;&#12540;&#12479;&#12399;Servlet    
中&#12391;      
Properties class &#12398;形&#12391;返送&#12373;&#12428;&#12414;&#12377;，&#12471;&#12473;&#12486;&#12512;&#12399;&#12461;&#12540; (key)    
&#20516; (value)&#12398;形&#12391; Servlet    
返送&#12497;&#12521;&#12513;&#12540;&#12479;&#12540;&#12522;&#12473;&#12488;&#12395;保存&#12375;&#12414;&#12377;<font color="#000000">。</font></font></p> 
<p style="margin-top: 1; margin-bottom: 1">　</p> 
<p style="text-indent: 20; margin-top: 1; margin-bottom: 1">　</p> 
<p style="margin-top: 1; margin-bottom: 1"><a href="#top"><font color="#003366" size="2">▲Top</font></a></p> 
<p style="margin-top: 1; margin-bottom: 1">　</p>
<p style="margin-top: 1; margin-bottom: 1">　</p>
<p style="margin-top: 1; margin-bottom: 1">　</p>
<p style="margin-top: 1; margin-bottom: 1"><font size="2"><b><a name="servletprop"></a>Servlet      
Call &#12503;&#12525;&#12497;&#12486;&#12451; (Servlet Call properties)</b></font></p>     
<p style="margin-top: 1; margin-bottom: 1">　</p>
<ul type="square">
  <li>
<p style="margin-top: 1; margin-bottom: 1">
<font size="2" color="#666699">Servlet Call ： </font></p>      
<p style="margin-top: 1; margin-bottom: 1">　</p>  
  <ul type="disc">  
    <li>  
<p style="margin-top: 1; margin-bottom: 1"><font size="2">  
<font color="#666699">URL ：</font> Servlet &#12398;URL。</font></p>    
    </li> 
    <li> 
<p style="margin-top: 1; margin-bottom: 1"><font size="2"><font color="#666699">&#12456;&#12531;&#12467;&#12540;&#12489; (encode)：</font>  
使用&#12391;&#12365;&#12427;&#12467;&#12540;&#12489; (character Set)    
例&#12360;&#12400; ： UTF-8，     
MS950，MS932 ...。</font></p>     
    </li> 
    <li> 
<p style="margin-top: 1; margin-bottom: 1"><font size="2"><font color="#666699">&#12497;&#12521;&#12513;&#12540;&#12479;&#12540; (parameters)：</font> 
Servlet&#12467;&#12540;&#12523;&#12395;伝達&#12377;&#12427;&#12497;&#12521;&#12513;&#12540;&#12479;&#12540;名(name)&#12392;&#20516; (value)。</font></p>     
    </li> 
  </ul> 
  </li> 
</ul> 
<blockquote> 
<p style="margin-top: 1; margin-bottom: 1"> 
<img border="0" src="images/ch11_05_perform_5.gif" width="419" height="325"></p> 
<p style="margin-top: 1; margin-bottom: 1"> 
　</p> 
</blockquote> 
<p style="margin-top: 1; margin-bottom: 1"><a href="#top"><font color="#003366" size="2">▲Top</font></a></p>
<p style="margin-top: 1; margin-bottom: 1">　</p>
<p style="margin-top: 1; margin-bottom: 1">　</p>
<p style="margin-top: 1; margin-bottom: 1">　</p>

<p style="margin-top: 1; margin-bottom: 1"><font size="2"><a name="servletsample"></a><b>Servlet 
&#12469;&#12531;&#12503;&#12523; (Servlet sample)</b></font></p>  
<!--
<p style="text-indent: 20; margin-top: 1; margin-bottom: 1">　</p>
<p style="text-indent: 20; margin-top: 1; margin-bottom: 1" align="justify"><font size="2">ServletCallTest 
&#12399;　HttpServlet &#12363;&#12425;&#32153;承&#12373;&#12428;&#12383;Servlet，ServletCallTest 將 jLIVE   
應用程式所傳入的參數，顯示在System.out 的 Console   
中，並計算參數個數，回覆的資料中，以鍵 <font face="Courier New"> &quot;parameter_count&quot;</font>   
和&#20540; &quot;參數個數&quot; 及鍵<font face="Courier New">&quot;test&quot;</font>和&#20540;<font face="Courier New">&quot;ok&quot;</font>   
傳回，設計師在 jLIVE 中可以運算式 <font face="Courier New" color="#666699"> GetServletResp(&quot;</font><font color="#666699">事件名稱</font><font face="Courier New" color="#666699">.parameter_count&quot;)</font>   
取&#20540;。<br>  
　</font></p>
<p style="text-indent: 20; margin-top: 1; margin-bottom: 1" align="justify"><font size="2">回覆的資料是以  
Properties class  
傳送，這是系統&#20839;定的規則，設計師必須將回覆資料以鍵 
(key) 與&#20540;(value) 的方式存入 Properties  
中，再按範例的程式碼將資料回傳。Servlet  
的設計師可以在讀取參數後，進行任何 Java&trade;  
所支援的運算，結果&#20540;再按上述的方式，傳回至應用程式中。</font></p> -->
<p style="margin-top: 1; margin-bottom: 1">　</p> 
<table border="1"> 
  <tr> 
    <td><font size="2" face="Courier New">import javax.servlet.*;<br>  
      import javax.servlet.http.*;<br>  
      import java.io.*;<br>  
      import java.util.*;<br>  
      import javax.swing.*;<br>  
      import java.net.*;<br>  
      import java.util.zip.*;<br>  
      import java.util.*;<br>  
      import java.text.*;<br>  
      import java.io.File;<br>  
      import java.io.IOException;<br>  
      <br>  
      <br>  
      public class ServletCallTest extends HttpServlet { </font>  
      <p><font size="2"><font face="Courier New">&nbsp;&nbsp;&nbsp; public void init(ServletConfig config) throws ServletException {<br>  
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; super.init(config);<br> 
      &nbsp;&nbsp;&nbsp; }<br> 
      &nbsp;&nbsp;&nbsp; public void doGet(HttpServletRequest req, HttpServletResponse  
      res) throws ServletException, IOException {<br>  
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; doPost(req, res);<br> 
      &nbsp;&nbsp;&nbsp; }<br> 
      &nbsp;&nbsp;&nbsp; public void doPost(HttpServletRequest req, HttpServletResponse  
      res) throws ServletException, IOException {<br>  
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Retrival parameters<br>  
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int paramcount = 0;<br>  
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Enumeration enum =  
      req.getParameterNames();<br> 
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; while(enum.hasMoreElements()) {<br>  
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String name = (String)  
      enum.nextElement();<br> 
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String[] values = (String[])  
      req.getParameterValues(name);<br> 
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  
      System.out.println(name);<br> 
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(values != null) {<br>  
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  
      for(int i = 0; i &lt; values.length; ++i) {<br>  
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  
      System.out.println(values[i]);<br> 
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  
      ++paramcount;<br> 
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  
      }<br> 
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br> 
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br> 
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //use the Properties class to return data<br>  
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Properties prop = new Properties();<br>  
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; prop.put(&quot;parameter_count&quot;,  
      String.valueOf(paramcount));<br> 
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; prop.put(&quot;test&quot;, "ok");<br>  
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DataOutputStream out = new  
      DataOutputStream(res.getOutputStream());<br> 
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; prop.store(out, "");<br>  
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; out.flush();<br> 
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; out.close();<br> 
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return;<br> 
      &nbsp;&nbsp;&nbsp; }<br> 
      &nbsp;&nbsp;&nbsp; public void destroy(){<br>  
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; super.destroy();<br> 
      &nbsp;&nbsp;&nbsp; }<br> 
      &nbsp;&nbsp;&nbsp; public String getServletInfo() {<br>  
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return &quot;Servlet Call Test";<br>  
      &nbsp;&nbsp;&nbsp; }<br> 
      }</font><br> 
      </font></td> 
  </tr> 
</table> 
<p style="margin-top: 1; margin-bottom: 1">　</p> 
<p style="margin-top: 1; margin-bottom: 1">　</p> 
<p style="margin-top: 1; margin-bottom: 1"><a href="#top"><font color="#003366" size="2">▲Top</font></a></p> 
<p style="margin-top: 1; margin-bottom: 1">　</p> 
<hr align=left color="#000000"> 
<table width=600 border=0 cellpadding=0 cellspacing=0 style="border-collapse: collapse" bordercolor="#111111"> 
<tr> 
<td width=200 align=left valign=top> 
<a href="ch11_05_05.html"> 
<img border="0" src="images/jlogo_previous.gif" width="70" height="18"></a></td> 
<td width=190 align=center valign=top><a href="index.html"> 
<img border="0" src="images/jlogo_small.gif" width="144" height="25"></a></TD> 
<td width=210 align=right valign=top> 
<a href="ch11_05_07.html"> 
<img border="0" src="images/jlogo_next.gif" width="70" height="18"></a></td> 
</tr> 
</table> 
 
<hr align=left color="#000000"> 
<p style="margin-top: 0; margin-bottom: 0"><font size="-1">Copyright &copy; 2001~  
2004 Probe Technology Inc. . All Rights Reserved.  
</font></p>  
  
<p style="margin-top: 0; margin-bottom: 0"><font size="-1">Questions, comments,  
and suggestions to <a href="mailto:Service@probe.com.tw">Service@probe.com.tw</a></font></p>  
  
      </td> 
    </tr> 
  </table> 
  </center> 
</div> 
  
      </body>  
  
</html>