<html>

<head>
<meta http-equiv="Content-Language" content="zh-tw">
<meta name="GENERATOR" content="Microsoft FrontPage 5.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<meta http-equiv="Content-Type" content="text/html; charset=big5">
<title>Listbox Component</title>
</head>

<body>

<div align="center">
  <center>
  <table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="600" id="AutoNumber1">
    <tr>
      <td width="100%">

<p style="margin-top: 0; margin-bottom: 0" align="center">
<a href="index.html"> 
<img border="0" src="images/jlogo.gif" width="345" height="60"></a></p> 
 
<table width=600 border=0 cellpadding=0 cellspacing=0 style="border-collapse: collapse" bordercolor="#111111"> 
<tr> 
<td width=200 align=left valign=top> 
<p style="margin-top: 0; margin-bottom: 0"> 
<a href="ch10_05.html"> 
<img border="0" src="images/jlogo_previous.gif" width="70" height="18"></a></td> 
<td width=194 align=center valign=top> 
<p style="margin-top: 0; margin-bottom: 0"><a href="ch10.html" style="text-decoration: none"><b>
<font color="#000000" face="新細明體" size="-1">Chapter 10</font></b><font color="#000000" face="新細明體">
</font></a>       
<p style="margin-top: 0; margin-bottom: 0"><b><font face="新細明體" size="-1">
<a href="ch10.html" style="text-decoration: none"><font color="#000000">
Components</font></a></font></b></TD>   
<td width=206 align=right valign=top>   
<p style="margin-top: 0; margin-bottom: 0">   
<a href="ch10_07.html">   
<img border="0" src="images/jlogo_next.gif" width="70" height="18"></a></td>   
</tr>   
</table>   
   
<hr align=left color="#000000">   
<p><font size="4"><b><a name="top"></a>清單方塊 (Listbox component)</b> 
<img border="0" src="images/dbtlistbox.gif" width="25" height="25"></font></p>    
<p style="margin-top: 2; margin-bottom: 2"><font size="2">  
<a href="ch10_00.html">共同屬性 (common properties)</a></font></p>    
<p style="margin-top: 2; margin-bottom: 2"><a href="#datasource"><font size="2">資料來源  
(data source)</font></a></p>   
<p style="margin-top: 2; margin-bottom: 2"><a href="#lookup"><font size="2">關連資料來源  
(lookup data source)</font></a></p>   
<p style="margin-top: 2; margin-bottom: 2"><a href="#event"><font size="2">事件  
(event)</font></a></p>   
<p style="margin-top: 2; margin-bottom: 2"><font size="2"><a href="#getsetprop">運算式屬性存取 
(formula get/set properties)</a></font></p>  
<p style="margin-top: 0; margin-bottom: 0">　</p>
<p style="text-indent: 20; margin-top: 0; margin-bottom: 0" align="justify"><font size="2">清單方塊   
(Listbox) 是以關連資料來源 (lookup data source) 或字串陣列&nbsp;  
(string array) 組成列示的清單項目(items)，當清單方塊連結  
(binding) 資料來源欄位 (data field) 時   
，清單方塊會以資料來源的資料欄位值 (data field)，搜尋關連資料來源  
(lookup data source) 的資料欄位值 (data field) 或字串陣列 (string array)，當其值相等時就標示該清單項目為選取項目。<br>  
　</font></p>
<p style="text-indent: 20; margin-top: 0; margin-bottom: 0" align="justify"><font size="2">清單方塊列示的項目(item)   
是以運算公式 (formula)   
的結果值顯示，所以顯示的項目不一定等於連結的資料欄位值，例如：聯結的資料欄位是代碼  
(code) 欄位而顯示的項目是代碼的文字描述 (description)   
欄位，使用者可以根據文字描述選取清單項目，而實際關連存檔的資料卻是代碼  
(code)。<br> 
　</font></p>
<p style="text-indent: 20; margin-top: 0; margin-bottom: 0" align="justify"><font size="2">清單方塊可以只選用關連資料來源  
(lookup data source)，而不連結 (binding) 資料來源 (data source)，如果設定 </font><font SIZE="2" color="#666699">被選時移至關連資料來源記錄&nbsp;</font><font size="2"><font color="#666699">   
</font>的屬性，可以將清單方塊當成是關連資料來源 (lookup data  
source) 的檔案記錄 (record)   
移動選擇器，使用者按選清單項目 (item)，關連資料來源  
(lookup data source) 即將目前檔案記錄 (current record) 移至 (move to)   
該項目的檔案記錄，並引發關連資料來源的讀取前後事件  
(before and after fetch event)，連結 (binding)   
此關連資料來源的其他元件都會自動更新內含值。<br>  
　</font></p>
<p style="text-indent: 20; margin-top: 0; margin-bottom: 0" align="justify"><font size="2">清單方塊是虛擬模式  
(virtual mode) 的元件，關連資料來源 (lookup data source)   
的檔案記錄 (record)   
在初始時，並不會全部讀入清單項目中，而是將客戶端  
(client) 目前關連資料來源緩衝區 (buffer)   
的檔案記錄讀入，當使用者以捲動軸流覽 (scroll)   
或關連資料欄位不在緩衝區 (buffer)   
且關連資料來源尚未至檔尾時，清單方塊會以背景執行緒  
(background thread) 按關連資料來源的擷取記錄數 (row fetch)，讀入檔案記錄  
(record) 至清單項目中。</font></p>  
<p style="text-indent: 20; margin-top: 0; margin-bottom: 0">　</p>  
<p style="text-indent: 20; margin-top: 0; margin-bottom: 0">　</p>  
<p style="margin-top: 0; margin-bottom: 0"><b><font size="2"><a name="datasource"></a>資料來源  
(data source)</font></b></p>   
<ul>   
  <li>   
<p style="margin-top: 1; margin-bottom: 1"><font size="2"><font color="#666699">資料來源  
(data source)：</font>選取資料來源。<br>
　</font></p>   
  </li>   
  <li>   
<p style="margin-top: 1; margin-bottom: 1"><font size="2"><font color="#666699">資料欄位  
(data field)：</font>選取資料欄位。<br>
　</font></p>   
  </li>   
  <li>   
<p style="margin-top: 1; margin-bottom: 1"><font size="2"><font color="#666699">項目尺寸  
(item size)：</font>清單方塊選項 (item) 的寬高。</font></p>   
  </li>   
</ul>   
<blockquote>   
<p style="margin-top: 0; margin-bottom: 0">   
<img border="0" src="images/ch10_06_ds.gif" width="476" height="477"></p>   
</blockquote>   
<p style="margin-top: 0; margin-bottom: 0">　</p>   
<p style="margin-top: 0; margin-bottom: 0"><a href="#top">   
<font color="#003366" size="2">▲Top</font></a></p>   
<p style="margin-top: 0; margin-bottom: 0">　</p>
<p style="margin-top: 0; margin-bottom: 0"><font color="#000000"><b>
<font size="2"><a name="lookup"></a>關連資料來源 (lookup data source)</font></b></font></p>   
<ul>   
  <li>   
<p style="margin-top: 1; margin-bottom: 1" align="justify"><font SIZE="2" color="#666699">被選時移至關連資料來源記錄：</font><font size="2">使用者選取清單方塊    
(Listbox) 的項目(item) 時，關連資料來源將目前的資料記錄  
(current record) 移至 (move to) 該項目的資料記錄 (record)    
，並引發關連資料來源的讀取前後事件(before and after fetch  
event)。而連結 (binding) 此關連資料來源的其他元件都會自動更新內含值。<br>
　</font></p>  
  </li>  
  <li>  
<p style="margin-top: 1; margin-bottom: 1"><font color="#666699" size="2">關連資料來源  
(lookup data source)：</font><font size="2">選取資料來源。<br>
　</font></p>   
  </li>   
  <li>   
<p style="margin-top: 1; margin-bottom: 1"><font color="#666699" size="2">關連資料欄位  
(lookup data field)：</font><font size="2">選取資料欄位。<br>
　</font></p>   
  </li>   
  <li>   
<p style="margin-top: 1; margin-bottom: 1"><font color="#666699" size="2">顯示運算式  
(display formula)：</font><font size="2">以運算式顯示項目資料(item)。<br>
　</font></p>  
  </li>  
  <li>  
<p style="margin-top: 1; margin-bottom: 1" align="justify"><font color="#666699" size="2">Icon資料欄位：</font><font size="2">在每個項目  
(item) 前顯示圖示，選擇性 (option) 屬性。選用時系統以欄位型別  
(field type) 判斷是 LONGVARBINARY 的圖檔資料或是 VARCHAR    
的圖檔名稱，若是圖檔名稱必須將圖檔儲存於應用程式模組的 class   
目錄中 Images 或 Preloadiamge 目錄下。<br>
　</font></p>  
  </li>  
  <li>  
<p style="margin-top: 1; margin-bottom: 1"><font color="#666699" size="2">字串陣列  
(string aray)：</font><font size="2">使用 &quot;字串陣列&quot;    
而不以關連資料來源為清單方塊的項目資料。&quot;關連&quot; 為資料欄位， &quot;選擇項目文字&quot;為顯示項目文字。<br>
　</font></p>   
  </li>   
  <li>   
<p style="margin-top: 1; margin-bottom: 1" align="justify"><font color="#666699" size="2">初選項  
(initial selection)：</font><font SIZE="2">關連資料來源初始化時清除選擇。如果清單方塊沒有連結  
(binding) 資料來源 (data source)，核選此屬性時，清單方塊初始為沒有任何選取項目的狀態，否則第一個項目為初始選項。如果清單方塊連結  
(binding) 資料來源 (data source)，此項屬性無作用，其初始選項為資料來源欄位  
(data source field) 與關連資料來源欄位 (lookup data source field)    
相等的資料項目。</font></p>   
  </li>   
</ul>   
<blockquote>   
<p style="margin-top: 0; margin-bottom: 0">   
<img border="0" src="images/ch10_06_lookup.gif" width="480" height="480"></p>   
</blockquote>   
<p style="margin-top: 0; margin-bottom: 0">　</p>   
<p style="margin-top: 0; margin-bottom: 0"><a href="#top">   
<font color="#003366" size="2">▲Top</font></a></p>   
<p style="margin-top: 0; margin-bottom: 0">　</p>
<p style="margin-top: 0; margin-bottom: 0"><a name="event"></a><b><font size="2">
事件 (event)</font></b></p>   
<ul type="square">   
  <li>   
<p style="margin-top: 1; margin-bottom: 1">   
<font size="2"><font color="#666699">動作事件 (action event)：</font>使用者按選  
(clicked)    
改變清單選項時，即引發事件 (fire event)。<br>
　</font></p>     
  </li>     
  <li>     
<p style="margin-top: 1; margin-bottom: 1">     
<font size="2"><font color="#666699">Gain Focus 事件：</font>當 Focus    
移入清單方塊時，即引發事件 。<br>
　</font></p>     
  </li>     
  <li>     
<p style="margin-top: 1; margin-bottom: 1">     
<font size="2"><font color="#666699">Lost Focus 事件：</font>當 Focus    
移出清單方塊時，即引發事件 。<br>
　</font></p>     
  </li>     
  <li>     
<p style="margin-top: 1; margin-bottom: 1">     
<font size="2"><font color="#666699">雙擊事件 (double click event)：</font>當雙擊滑鼠的左鍵時，即引發事件。<br>
　</font></p>     
  </li>     
  <li>     
<p style="margin-top: 1; margin-bottom: 1">     
<font size="2"><font color="#666699">按右鍵事件 (right click event)：</font>當按下滑鼠右鍵時，即引發事件。</font></p>     
  </li>     
</ul>     
<blockquote>     
<p style="margin-top: 0; margin-bottom: 0">     
<img border="0" src="images/ch10_06_event.gif" width="476" height="476"></p>     
</blockquote>     
<p style="margin-top: 0; margin-bottom: 0">　</p>   
<p style="margin-top: 0; margin-bottom: 0"><a href="#top">   
<font color="#003366" size="2">▲Top</font></a></p>   
<p style="margin-top: 0; margin-bottom: 0">　</p>   
<p style="margin-top: 0; margin-bottom: 0"><font size="2"><a name="getsetprop"></a><b>運算式屬性存取 
(formula get/set properties)</b></font></p>

<p style="text-indent: 20"><font size="2"><font color="#666699">SetProp(&quot;元件名稱&quot;,  
&quot;屬性&quot;,&nbsp; 值) </font>：屬性設定。</font></p> 
 
<p style="text-indent: 20"><font size="2"><font color="#666699">SetProp(&quot;</font><font color="#666699">元件名稱</font><font color="#666699">&quot;,  
&quot;</font><font color="#666699">屬性</font><font color="#666699">&quot;,&nbsp; 值</font><font color="#666699">1,&nbsp; 值</font><font color="#666699">2)</font>：屬性設定。</font></p> 
 
<p style="text-indent: 20"><font size="2"><font color="#666699">GetProp(&quot;</font><font color="#666699">元件名稱</font><font color="#666699">&quot;,  
&quot;</font><font color="#666699">屬性</font><font color="#666699">&quot;)</font>：屬性讀取。</font></p> 
 
<table border="1" style="border-collapse: collapse" bordercolor="#111111" cellspacing="1" cellpadding="2" width="100%">  
  <tr>  
    <td colspan="4" bgcolor="#666699"><font size="2" color="#FFFFFF">Set   
      Properties</font></td>  
  </tr>  
  <tr>  
    <td align="center" bgcolor="#505050"><font color="#FFFFFF" size="2">屬性<br> 
&nbsp;(Properties)&nbsp;</font></td>  
    <td align="center" bgcolor="#505050"><font color="#FFFFFF" size="2">值1<br> 
&nbsp;(Value 1)</font></td>  
    <td align="center" bgcolor="#505050"><font color="#FFFFFF" size="2">值2<br> 
&nbsp;(Value 2)</font></td>  
    <td align="center" bgcolor="#505050"><font color="#FFFFFF" size="2">說明<br> 
&nbsp;(Descriptions)</font></td>  
  </tr>  
  <tr>  
    <td><font size="2">enabled</font></td>  
    <td><font size="2">1 致能，0 失效</font></td>  
    <td>　</td>  
    <td><font size="2">致能與失效。</font></td>  
  </tr>  
  <tr>  
    <td><font size="2">setfocus</font></td>  
    <td><font size="2">1 設定 Focus</font></td>  
    <td>　</td> 
    <td><font size="2">設定 Focus。</font></td>  
  </tr>  
  <tr>  
    <td><font size="2">visible</font></td>  
    <td><font size="2">1 顯示，0 隱藏</font></td>  
    <td>　</td>  
    <td><font size="2">顯示與隱藏。</font></td>  
  </tr>  
  <tr>  
    <td><font size="2">repaint</font></td>  
    <td><font size="2">1 重繪，2   
      立即重繪</font></td>  
    <td>　</td>  
    <td><font size="2">重繪。</font></td>  
  </tr>  
  <tr>  
    <td><font size="2">revalidate</font></td>  
    <td><font size="2">1 重整清單方塊資料</font></td>  
    <td>　</td>  
    <td><font size="2">重整清單方塊資料。</font></td>  
  </tr>  
  <tr>  
    <td><font size="2">selected</font></td>  
    <td><font size="2">N 選取第 N 個選擇項目</font></td>  
    <td>　</td>  
    <td><font size="2">選取第 N 個選擇項目，N 由 1 起算，N = 0   
      清除選取。</font></td>  
  </tr>  
  <tr>
    <td><font size="2">bg</font></td>   
    <td><font size="2">RGB(red, green, blue)</font></td>   
    <td>　</td>   
    <td><font size="2">背景顏色。值1 必須以Formula 的 RGB() 運算式給值。&nbsp; 
    </font></td>   
  </tr>
  <tr>
    <td><font size="2">fg</font></td>   
    <td><font size="2">RGB(red, green, blue)</font></td>   
    <td>　</td>   
    <td><font size="2">前景顏色。值1 必須以Formula 的 RGB() 運算式給值。&nbsp; 
    </font></td>   
  </tr>
  <tr>
    <td><font size="2">x</font></td>   
    <td><font size="2">正整數值</font></td>   
    <td>　</td>   
    <td><font size="2">左座標位置。</font></td>   
  </tr>
  <tr>
    <td><font size="2">y</font></td>   
    <td><font size="2">正整數值</font></td>   
    <td>　</td>   
    <td><font size="2">上座標位置。</font></td>   
  </tr>
  <tr>
    <td><font size="2">w</font></td>   
    <td><font size="2">正整數值</font></td>   
    <td>　</td>   
    <td><font size="2">元件寬度。</font></td>   
  </tr>
  <tr>
    <td><font size="2">h</font></td>   
    <td><font size="2">正整數值</font></td>   
    <td>　</td>   
    <td><font size="2">元件高度。</font></td>   
  </tr>
  <tr>
    <td><font size="2">xy</font></td>   
    <td><font size="2">正整數值</font></td>   
    <td><font size="2">正整數值</font></td>   
    <td><font size="2">左(Value1) 上(Value2) 座標位置。</font></td>   
  </tr>
  <tr>
    <td><font size="2">wh</font></td>   
    <td><font size="2">正整數值</font></td>   
    <td><font size="2">正整數值</font></td>   
    <td><font size="2">元件寬(Value1) 高(value2)度。</font></td>   
  </tr>
  <tr>  
    <td colspan="4" bgcolor="#666699"><font size="2" color="#FFFFFF">Get   
      Properties</font></td>  
  </tr>  
  <tr>  
    <td bgcolor="#505050" align="center"><font color="#FFFFFF" size="2">屬性(Properties)</font></td>  
    <td bgcolor="#505050" colspan="2" align="center"><font color="#FFFFFF" size="2">傳回值   
      (Return value)</font></td>  
    <td bgcolor="#505050" align="center"><font color="#FFFFFF" size="2">說明 (Descriptions)</font></td>  
  </tr>  
  <tr>  
    <td><font size="2">isenabled</font></td>  
    <td colspan="2"><font size="2">1 致能，0 失效</font></td>  
    <td><font size="2">致能與失效。</font></td>  
  </tr>  
  <tr>  
    <td><font size="2">isvisible</font></td>  
    <td colspan="2"><font size="2">1 顯示，0 隱藏</font></td>  
    <td><font size="2">顯示與隱藏。</font></td>  
  </tr>  
  <tr>
    <td><font size="2">selected</font></td>  
    <td colspan="2"><font size="2">N 被選取的是第 N 個選擇項目</font></td>  
    <td><font size="2">被選取的是第N個選擇項目，N由 1 起算，N=0 未選取。</font></td>  
  </tr>
  <tr>
    <td><font size="2">selectedcode</font></td>   
    <td colspan="2"><font size="2">被選取的關連資料值。</font></td>   
    <td><font size="2">被選取的關連資料值。沒有選取列時回傳空字串。</font></td>   
  </tr>
  <tr>
    <td><font size="2">selectedtext</font></td>   
    <td colspan="2"><font size="2">被選取的顯示資料值。</font></td>   
    <td><font size="2">被選取的顯示資料值。沒有選取列時回傳空字串。</font></td>   
  </tr>
  <tr>
    <td><font size="2">x</font></td>   
    <td colspan="2"><font size="2">整數值</font></td>   
    <td><font size="2">左座標位置。</font></td>   
  </tr>
  <tr>
    <td><font size="2">y</font></td>   
    <td colspan="2"><font size="2">整數值</font></td>   
    <td><font size="2">上座標位置。</font></td>   
  </tr>
  <tr>
    <td><font size="2">w</font></td>   
    <td colspan="2"><font size="2">整數值</font></td>   
    <td><font size="2">元件寬度。</font></td>   
  </tr>
  <tr>
    <td><font size="2">h</font></td>   
    <td colspan="2"><font size="2">整數值</font></td>   
    <td><font size="2">元件高度。</font></td>   
  </tr>
</table>  
  
<p><a href="#top"><font color="#003366" size="2">▲Top</font></a></p>  
  
<p style="margin-top: 0; margin-bottom: 0">　</p>   
<p style="margin-top: 0; margin-bottom: 0">　</p>  
<hr align=left color="#000000">  
<table width=600 border=0 cellpadding=0 cellspacing=0 style="border-collapse: collapse" bordercolor="#111111">  
<tr>  
<td width=200 align=left valign=top>  
<a href="ch10_05.html">  
<img border="0" src="images/jlogo_previous.gif" width="70" height="18"></a></td>  
<td width=196 align=center valign=top><a href="index.html">  
<img border="0" src="images/jlogo_small.gif" width="144" height="25"></a></TD>  
<td width=204 align=right valign=top>  
<a href="ch10_07.html">  
<img border="0" src="images/jlogo_next.gif" width="70" height="18"></a></td>  
</tr>  
</table>  
  
<hr align=left color="#000000">  
<p style="margin-top: 0; margin-bottom: 0"><font size="-1">Copyright &copy; 2001~     
2004 Probe Technology . All Rights Reserved.</font></p>    
    
<p style="margin-top: 0; margin-bottom: 0"><font size="-1">Questions, comments,     
and suggestions to <a href="mailto:Service@probe.com.tw">Service@probe.com.tw</a></font></p>    
    
      </td> 
    </tr> 
  </table> 
  </center> 
</div> 
    
      </body>   
   
</html>